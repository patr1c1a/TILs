# January 2025

## 02

### Fluent interface pattern for call chaining

_Tags: #Patterns_

I recently implemented the fluent interface design pattern in quite a simple case to improve readability:

There was this class with some methods with no return value:

```csharp
internal class Class_A
{
    internal void Method1(string parameter)
    {
        _someObject.DoSomething(parameter);
    }

    internal void Method2(int parameter1, string parameter2)
    {
        parameter1.Execute();
        parameter2.DoSomethingElse();
    }
}
```

And that class was used by several other classes where these methods had to be called multiple times:

```csharp
internal class Class_B
{
    private Class_A _classA;

    internal void Method3()
    {
        _classA.Method1("some parameter");
        _classA.Method1("some other parameter");
        _classA.Method2(123, "another parameter");
        _classA.Method1("and one more");
    }
}
```

The calls to methods from Class_A were really a lot and they were one after the other. For context, this was a Selenium project where Class_A had methods to interact with the browser elements and Class_B was the one guiding that interaction, so methods from Class_A had to be called multiple times, one after the other.

The way the fluent interface pattern was implemented here was to make methods from Class_A return an object of the very same type:

```csharp
internal class Class_A
{
    internal Class_A Method1(string parameter)
    {
        _someObject.DoSomething(parameter);
        return this;
    }

    internal Class_A Method2(int parameter1, string parameter2)
    {
        parameter1.Execute();
        parameter2.DoSomethingElse();
        return this;
    }
}
```

This made Class_B more readable by allowing to chain method calls:

```csharp
internal class Class_B
{
    private Class_A _classA;

    internal void Method3()
    {
        _classA.Method1("some parameter");
            .Method1("some other parameter");
            .Method2(123, "another parameter");
            .Method1("and one more");
    }
}
```
